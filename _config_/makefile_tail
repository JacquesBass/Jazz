# Targets (1): Compiling mode switching
# ------------

compile_mode_debug:
	@echo "Switching to compile mode DEBUG ..."
	@make clean
	@touch compile_mode_debug
	$(eval CPPFLAGS = $(DFLAGS))

compile_mode_release:
	@echo "Switching to compile mode RELEASE ..."
	@make clean
	@touch compile_mode_release
	$(eval CPPFLAGS = $(RFLAGS))

compile_mode_test:
	@echo "Switching to compile mode DEBUG&TEST ..."
	@make clean
	@touch compile_mode_test
	$(eval CPPFLAGS = $(TFLAGS))

# Targets (2): Making the executable
# ------------

djazz: compile_mode_debug $(objects) mdb.o midl.o
	@echo "Making DEBUG Jazz ..."
	g++ -o djazz $(objects) mdb.o midl.o -I$(mhd_libpath) -L$(mhd_libpath) -lmicrohttpd -lpthread

jazz: compile_mode_release $(objects) mdb.o midl.o
	@echo "Making RELEASE Jazz ..."
	g++ -o jazz $(objects) mdb.o midl.o -I$(mhd_libpath) -L$(mhd_libpath) -lmicrohttpd -lpthread

tjazz: compile_mode_test $(objects) mdb.o midl.o
	@echo "Making DEBUG&TEST Jazz ..."
	g++ -o tjazz $(objects) mdb.o midl.o -I$(mhd_libpath) -L$(mhd_libpath) -lmicrohttpd -lpthread

# Targets (3): Phony targets
# ------------

.PHONY : clean
clean  :
	@echo "Cleaning up all files not stored in the repo ..."
	@rm -f *.o
	@rm -f *jazz
	@rm -f compile_mode_*

.PHONY : info
info   :
	@echo "Current Jazz version   : $(VERSION)"
	@echo "Current Jazz home      : $(HOME)"
	@echo "Current Linux platform : $(LINUX)"
	@echo "Current CPPFLAGS       : $(CPPFLAGS)"
	@echo "Current CXXFLAGS       : $(CXXFLAGS)"

.PHONY  : runtest
runtest : tjazz
	@echo "Not implemented ..."

# Targets (3): System targets
# ------------

.PHONY  : install
install :
	@echo "Not implemented ..."

.PHONY    : uninstall
uninstall :
	@echo "Not implemented ..."
